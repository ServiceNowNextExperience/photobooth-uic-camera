<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ux_lib_asset">
    <sys_ux_lib_asset action="INSERT_OR_UPDATE">
        <bundled_asset>false</bundled_asset>
        <category>component</category>
        <checksum>e15166b12ae84dfa5df4e8f29155ecab</checksum>
        <config_option/>
        <content>import*as e from"/uxasset/externals/@servicenow/ui-renderer-snabbdom/index.jsdbx";
import*as t from"/uxasset/externals/@servicenow/ui-core/index.jsdbx";
/*__ESM_BODY_START__*/
var a={416:e=&gt;{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a="",o=void 0!==t[5];return t[4]&amp;&amp;(a+="@supports (".concat(t[4],") {")),t[2]&amp;&amp;(a+="@media ".concat(t[2]," {")),o&amp;&amp;(a+="@layer".concat(t[5].length&gt;0?" ".concat(t[5]):""," {")),a+=e(t),o&amp;&amp;(a+="}"),t[2]&amp;&amp;(a+="}"),t[4]&amp;&amp;(a+="}"),a})).join("")},t.i=function(e,a,o,n,r){"string"==typeof e&amp;&amp;(e=[[null,e,void 0]]);var i={};if(o)for(var s=0;s&lt;this.length;s++){var l=this[s][0];null!=l&amp;&amp;(i[l]=!0)}for(var c=0;c&lt;e.length;c++){var d=[].concat(e[c]);o&amp;&amp;i[d[0]]||(void 0!==r&amp;&amp;(void 0===d[5]||(d[1]="@layer".concat(d[5].length&gt;0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),a&amp;&amp;(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=a):d[2]=a),n&amp;&amp;(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),t.push(d))}},t}},738:e=&gt;{e.exports=function(e){return e[1]}},223:(e,t,a)=&gt;{a.r(t),a.d(t,{default:()=&gt;s});var o=a(738),n=a.n(o),r=a(416),i=a.n(r)()(n());i.push([e.id,':host{box-sizing:border-box;font-family:var(--now-font-family,"Source Sans Pro",sans-serif);line-height:var(--now-line-height,1.25)}:host([hidden]){display:none}*,:after,:before{box-sizing:border-box}video{transform:scaleX(-1)}@keyframes flasher{0%{background-color:#fff}25%{background-color:#fff}to{background-color:none}}#flash{height:100%;left:0;position:absolute;top:0;width:100%;z-index:1000}.snapping #flash{animation:flasher;display:default}#container{align-items:center;box-sizing:border-box;justify-content:center;position:relative}#container div{position:absolute}.countdown #counter,.countdown #flash,.idle #counter,.idle #flash{display:none}.snapping #counter,.snapping #flash{display:default}.preview #counter{display:none}',""]);const s=i},560:(e,t,a)=&gt;{var o=a(223);o&amp;&amp;o.__esModule&amp;&amp;(o=o.default),e.exports="string"==typeof o?o:o.toString()},197:e=&gt;{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t&lt;arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&amp;&amp;(e[o]=a[o])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(this,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},o={};function n(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,exports:{}};return a[e](r,r.exports,n),r.exports}n.n=e=&gt;{var t=e&amp;&amp;e.__esModule?()=&gt;e.default:()=&gt;e;return n.d(t,{a:t}),t},n.d=(e,t)=&gt;{for(var a in t)n.o(t,a)&amp;&amp;!n.o(e,a)&amp;&amp;Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=&gt;Object.prototype.hasOwnProperty.call(e,t),n.r=e=&gt;{"undefined"!=typeof Symbol&amp;&amp;Symbol.toStringTag&amp;&amp;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=&gt;{var a={};n.r(a);var o=n(197),r=n.n(o);const i=(e=&gt;{var t={};return n.d(t,e),t})({createElement:()=&gt;{const t=e.default&amp;&amp;e.__esModule;return t?e.default.createElement:e.createElement||e.default&amp;&amp;e.default.createElement},default:()=&gt;{const t=e.default&amp;&amp;e.__esModule;return t?e.default&amp;&amp;e.default.default?e.default.default:e.default:t?e.default.default:e.default?e.default.default?e.default.default:e.default:e}});const s=(e=&gt;{var t={};return n.d(t,e),t})({actionTypes:()=&gt;{const e=t.default&amp;&amp;t.__esModule;return e?t.default.actionTypes:t.actionTypes||t.default&amp;&amp;t.default.actionTypes},createCustomElement:()=&gt;{const e=t.default&amp;&amp;t.__esModule;return e?t.default.createCustomElement:t.createCustomElement||t.default&amp;&amp;t.default.createCustomElement}});var l=n(560),c=n.n(l);const d=e=&gt;{let{watermarkImageUrl:t,watermarkImageHeight:a}=e;return console.log("Initialize Watermark",t),new Promise((e=&gt;{if(t){const o=new Image;o.onload=t=&gt;{let{target:{width:n,height:r}}=t;const i=a?a/r:1;o.width=n*i,o.height=r*i,e({watermarkImage:o})},o.onerror=()=&gt;{e({watermarkImage:new Image,error:`Unable to resolve image with url ${t}`})},o.src=t}else e({watermarkImage:new Image})}))},u=e=&gt;{let{watermarkImagePosition:t,imageWidth:a,imageHeight:o,canvas:{width:n,height:r},gap:i=10}=e;const[s,l]=[i,i],c=n/2-a/2,d=r/2-o/2,u=0+s,p=0+l,m=n-a-s,h=r-o-l;switch(console.log({watermarkImagePosition:t,imageWidth:a,imageHeight:o,canvasWidth:n,canvasHeight:r,offsetX:s,offsetY:l,xRight:m}),t){case"top-left":return[u,p];case"top-center":return[c,p];case"top-right":return[m,p];case"bottom-left":return[u,h];case"bottom-center":return[c,h];case"bottom-right":return[m,h];case"center":return[c,d];default:return[0+i,0+i]}};function p(e){let{video:t,cameraDeviceId:a="",enabled:o}=e;return console.log("SELECT MEDIA DEVICE",{cameraDeviceId:a,enabled:o}),new Promise(((e,n)=&gt;{navigator.mediaDevices.getUserMedia({video:{deviceId:a}}).then((n=&gt;{console.log("Got User Media!",{video:t,cameraDeviceId:a,stream:n}),t.srcObject&amp;&amp;t.srcObject.getTracks().forEach((e=&gt;{e.stop()})),t.srcObject=n,m({video:t,enabled:o}),t.play(),e(n)})).catch((e=&gt;{console.log("Error Getting Media!",e),n({exc:e})}))}))}function m(e){let{video:{srcObject:t},enabled:a}=e;!t||!0!==a&amp;&amp;!1!==a||t.getTracks().forEach((e=&gt;e.enabled=a))}function h(e,t){let{imageSize:{width:a,height:o},fillStyle:n=null}=t;e.canvas.width=a,e.canvas.height=o,e.fillStyle=n||e.fillStyle,e.fillRect(0,0,a,o)}function g(e,t,a){let{x:o=0,y:n=0,width:r,height:i}=a;e.drawImage(t,o,n,r,i)}function f(e){let{state:t,updateState:a}=e;const{video:o,context:n,shutterSound:r,properties:{countdownDurationSeconds:i,pauseDurationSeconds:s=1,pauseDurationMilliseconds:l=1e3*s,gap:c=10,chin:d=0,imageSize:u={width:800,height:600},fillStyle:p,numberOfSnaps:m}}=t,f=[];let v=1;const b={width:u.width+3*c,height:u.height+3*c+d};h(n,{imageSize:b,fillStyle:p}),i&gt;0&amp;&amp;a({snapState:"countdown"});for(let e=0;e&lt;m;e++){const e=n.canvas.ownerDocument.createElement("canvas").getContext("2d");h(e,{imageSize:u}),f.push(e)}return new Promise((e=&gt;{const t=()=&gt;{console.log("_snap",v,n),a({snapState:"snapping"}),r&amp;&amp;r.play();!function(e){let{pos:t,context:a,video:o,gap:n,chin:r,scaleFactor:i}=e;console.log("drawToSnapImage",{context:a});const{width:s,height:l}=a.canvas,c=(s-3*n)/i,d=(l-3*n-r)/i,u={1:{x:n,y:n},2:{x:c+2*n,y:n},3:{x:n,y:d+2*n},4:{x:c+2*n,y:d+2*n}},{x:p,y:m}=u[t];g(a,o,{x:p,y:m,width:c,height:d})}({pos:v,context:n,video:o,gap:c,chin:d,scaleFactor:1===m?1:2});g(f[v-1],o,u),v&lt;m?(v++,setTimeout(t,l)):(a({snapState:"idle"}),e({context:n,singleSnapContexts:f}))};setTimeout(t,1e3*i)}))}const v="PHOTOBOOTH_CAMERA#AVAILABLE_CAMERAS_UPDATED",b="PHOTOBOOTH_CAMERA#DBLCLICK",{COMPONENT_CONNECTED:w,COMPONENT_PROPERTY_CHANGED:y,COMPONENT_DOM_READY:S}=s.actionTypes,E={snapRequested:e=&gt;{let{state:t,dispatch:a,updateState:o,payload:{value:n,previousValue:i}}=e;const{watermarkImage:s,properties:l}=t;n!=i&amp;&amp;(console.log("SNAP STARTED"),f({state:t,updateState:o}).then((e=&gt;{let{context:t,singleSnapContexts:o}=e;console.log("SNAP COMPLETED",{context:t,singleSnapContexts:o}),(e=&gt;{let{watermarkImage:t,context:a,watermarkImagePosition:o,gap:n}=e;if(console.log("applyWatermark",t),!t)return;const[r,i]=u({watermarkImagePosition:o,imageWidth:t.width,imageHeight:t.height,canvas:a.canvas,gap:n});a.drawImage(t,r,i,t.width,t.height)})(r()({context:t,watermarkImage:s},l));const n=t.canvas.toDataURL("image/jpeg");a("PHOTOBOOTH_CAMERA#SNAPPED",{imageData:n});const i=o.map((e=&gt;e.canvas.toDataURL("image/jpeg")));a("PHOTOBOOTH_CAMERA#SINGLES_SNAPPED",{individualSnaps:i})})))},enabled:e=&gt;{let{state:{video:t},payload:{value:a},properties:{cameraDeviceId:o},dispatch:n}=e;a&amp;!t.srcObject?p({video:t,cameraDeviceId:o,enabled:a}).then((()=&gt;{(function(e){let{deviceType:t="videoinput",cameraDeviceId:a}=e;return new Promise((e=&gt;{navigator.mediaDevices.enumerateDevices().then((o=&gt;{const n=o.filter((e=&gt;e.kind===t));n.forEach((e=&gt;e.id=e.deviceId));const r={selectedCameraDeviceId:a,cameras:n,selectedDeviceIdFound:!1,boundCameraDeviceId:null};if(1==n.filter((e=&gt;e.deviceId===a)).length)r.selectedDeviceIdFound=!0,r.boundCameraDeviceId=a;else if(1===n.length){const e=n[0].deviceId;r.selectedDeviceIdFound=e===a,r.boundCameraDeviceId=e}e(r)}))}))})({cameraDeviceId:o}).then((e=&gt;{console.log(v,e),n(v,e)})).catch((e=&gt;{console.log("ERROR getConnectedDevices",e),n(v,e)}))})).catch((e=&gt;{console.log("ERROR selectMediaDevice",e)})):m({video:t,enabled:a})},cameraDeviceId:e=&gt;{let{state:{video:t},payload:{value:a},updateState:o,properties:{enabled:n}}=e;n&amp;&amp;p({video:t,cameraDeviceId:a,enabled:n})},watermarkImageUrl:e=&gt;{let{properties:t,updateState:a}=e;d(t).then((e=&gt;{let{watermarkImage:t,error:o}=e;a({watermarkImage:t})}))},watermarkImageHeight:e=&gt;{let{properties:t,updateState:a}=e;d(t).then((e=&gt;{let{watermarkImage:t,error:o}=e;a({watermarkImage:t})}))},refreshRequested:()=&gt;{console.log("REFRESH REQUESTED"),window.location.reload()}},I={[S]:e=&gt;{let{host:t,state:{properties:a},updateState:o,dispatch:n}=e;console.log(S,t,a),(e=&gt;{let{host:t,updateState:a,dispatch:o,properties:n,properties:{shutterSoundFile:r}}=e;console.log("INITIALIZE MEDIA!"),d(n).then((e=&gt;{let{watermarkImage:t,error:o}=e;a({watermarkImage:t})}));const i=t.shadowRoot.getElementById("video"),s=t.shadowRoot.ownerDocument.createElement("canvas").getContext("2d");if(r){const e=new Audio(r);a({shutterSound:e})}a({video:i,context:s})})({host:t,properties:a,dispatch:n,updateState:o}),function(e){let{document:t}=e;const a=t.getElementsByTagName("head")[0];function o(e,a,o){const n=t.createElement("link");return e&amp;&amp;n.setAttribute("rel",e),a&amp;&amp;n.setAttribute("href",a),o&amp;&amp;n.setAttribute("sizes",o),n}function n(e,a){const o=t.createElement("meta");return o.setAttribute("name",e),o.setAttribute("content",a),o}a.appendChild(n("apple-mobile-web-app-capable","yes")),a.appendChild(n("apple-mobile-web-app-status-bar-style","black")),a.appendChild(n("apple-mobile-web-app-title","Photobooth")),a.appendChild(o("apple-touch-icon","x_snc_pb_app.photobooth_touch_icon_180.png")),a.appendChild(o("apple-touch-startup-image","x_snc_pb_app.photobooth_launch.png"))}(window)},[w]:e=&gt;{let{properties:t}=e;console.log(w,t)},[y]:e=&gt;{let{host:t,state:a,action:{payload:{name:o,value:n,previousValue:r}},dispatch:i,updateState:s}=e;console.log(y,{name:o,value:n}),E[o]&amp;&amp;E[o]({host:t,state:a,dispatch:i,updateState:s,payload:{value:n,previousValue:r},properties:a.properties})}};(0,s.createCustomElement)("snc-photobooth-uic-camera",{renderer:{type:i.default},view:(e,t)=&gt;{let{snapState:a,properties:{pauseDurationSeconds:o,animationDuration:n=o+"s"}}=e,{dispatch:r}=t;return(0,i.createElement)("div",{id:"container",className:a,"on-dblclick":e=&gt;{let{clientX:t,clientY:a}=e;console.log(b,{clientX:t,clientY:a}),r(b,{clientX:t,clientY:a})}},(0,i.createElement)("div",{id:"flash",style:{"animation-iteration-count":4,"animation-duration":n}}),(0,i.createElement)("video",{id:"video",autoplay:!0,muted:!0,style:{width:"100%"}}))},styles:c(),initialState:{snapState:"idle",watermarkImage:null},actionHandlers:I,dispatches:{PHOTOBOOTH_CAMERA_SNAPPED:{},PHOTOBOOTH_CAMERA_SINGLES_SNAPPED:{},PHOTOBOOTH_AVAILABLE_CAMERAS_UPDATED:{},PHOTOBOOTH_CAMERA_DOUBLE_CLICK:{}},properties:{enabled:{schema:{type:"boolean"},default:!1},snapRequested:{default:"",schema:{type:"string"}},countdownDurationSeconds:{default:0,schema:{type:"number"}},pauseDurationSeconds:{default:1,schema:{type:"number"}},imageSize:{default:{width:800,height:600},schema:{type:"object",properties:{width:{type:"integer"},height:{type:"integer"}},required:["width","height"]}},gap:{default:10,schema:{type:"number"}},chin:{default:50,schema:{type:"number"}},fillStyle:{default:"lightgreen",schema:{type:"string"}},cameraDeviceId:{default:"",schema:{type:"string"}},watermarkImageUrl:{schema:{type:"string"},default:""},watermarkImagePosition:{schema:{type:"string",enum:["top-left","top-center","top-right","bottom-left","bottom-center","bottom-right","center"]},default:"bottom-center"},watermarkImageHeight:{schema:{type:"number"},default:null},shutterSoundFile:{schema:{type:"string"},default:""},refreshRequested:{schema:{type:"string"},default:""},numberOfSnaps:{schema:{type:"string",enum:["1","4"]},default:"4"}}}),window.__TECTONIC__$snc_photobooth_uic_camera=a})();
/*__ESM_BODY_END__*/
//# sourceMappingURL=/uxasset/externals/@snc/photobooth-uic-camera/index.min.js.map.jsdbx</content>
        <content_meta>{"tectonicVersion":"26.4.0","imports":[{"kind":"import-statement","path":"/uxasset/externals/@servicenow/ui-renderer-snabbdom/index.jsdbx"},{"kind":"import-statement","path":"/uxasset/externals/@servicenow/ui-core/index.jsdbx"}],"exports":[]}</content_meta>
        <dependencies/>
        <es_module>true</es_module>
        <is_attachment>false</is_attachment>
        <mime_type>application/javascript</mime_type>
        <name>@snc/photobooth-uic-camera/index</name>
        <sys_class_name>sys_ux_lib_asset</sys_class_name>
        <sys_created_by>jon.lind</sys_created_by>
        <sys_created_on>2024-05-15 19:47:42</sys_created_on>
        <sys_id>6a3946e76f429e1cfa6597d5d98a93bf</sys_id>
        <sys_mod_count>477095</sys_mod_count>
        <sys_name>@snc/photobooth-uic-camera/index</sys_name>
        <sys_package display_value="Photobooth UIC Camera" source="x_snc_pb_camera">fe8710bf47ce9d10552caf52736d432a</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Photobooth UIC Camera">fe8710bf47ce9d10552caf52736d432a</sys_scope>
        <sys_update_name>sys_ux_lib_asset_6a3946e76f429e1cfa6597d5d98a93bf</sys_update_name>
        <sys_updated_by>jon.lind</sys_updated_by>
        <sys_updated_on>2024-06-04 22:14:31</sys_updated_on>
    </sys_ux_lib_asset>
</record_update>
